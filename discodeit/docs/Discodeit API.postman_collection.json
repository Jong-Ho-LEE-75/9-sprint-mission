{
  "info": {
    "name": "Discodeit API",
    "description": "Discodeit API 자동 테스트 컬렉션\n\n웹 API 요구사항 순서대로 테스트가 구성되어 있습니다.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "discodeit-api"
  },
  "item": [
    {
      "name": "사용자 관리",
      "item": [
        {
          "name": "사용자 등록",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 201) {",
                  "        const error = pm.response.json();",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200 또는 201) - ${error.message || ''}`);",
                  "    }",
                  "    ",
                  "    const user = pm.response.json();",
                  "    if (!user.id) {",
                  "        throw new Error('생성된 사용자에 ID가 없음');",
                  "    }",
                  "    ",
                  "    if (!user.email) {",
                  "        throw new Error('생성된 사용자에 이메일이 없음');",
                  "    }",
                  "    ",
                  "    // 다음 테스트를 위해 생성된 사용자 ID 저장",
                  "    pm.environment.set('createdUserId', user.id);",
                  "    ",
                  "    pm.test('사용자 등록 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`사용자 등록 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "// 매번 다른 이메일 생성",
                  "pm.environment.set('randomEmail', 'newuser' + Date.now() + '@example.com');"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"새로운사용자\",\n  \"email\": \"{{randomEmail}}\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users",
              "host": ["{{baseUrl}}"],
              "path": ["users"]
            }
          },
          "response": []
        },
        {
          "name": "사용자 정보 수정",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const user = pm.response.json();",
                  "    const expectedId = pm.environment.get('user2Id');",
                  "    if (user.id !== expectedId) {",
                  "        throw new Error(`사용자 ID 변경됨: ${user.id} (예상: ${expectedId})`);",
                  "    }",
                  "    ",
                  "    pm.test('사용자 정보 수정 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`사용자 정보 수정 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"{{user2Name}}_수정됨\",\n  \"email\": \"{{user2Email}}\",\n  \"password\": \"newpassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users/{{user2Id}}",
              "host": ["{{baseUrl}}"],
              "path": ["users", "{{user2Id}}"]
            }
          },
          "response": []
        },
        {
          "name": "사용자 삭제",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 204) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200 또는 204)`);",
                  "    }",
                  "    ",
                  "    pm.test('사용자 삭제 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`사용자 삭제 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/users/{{createdUserId}}",
              "host": ["{{baseUrl}}"],
              "path": ["users", "{{createdUserId}}"]
            }
          },
          "response": []
        },
        {
          "name": "모든 사용자 조회",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const users = pm.response.json();",
                  "    if (!Array.isArray(users)) {",
                  "        throw new Error('응답이 배열이 아님');",
                  "    }",
                  "    ",
                  "    if (users.length === 0) {",
                  "        throw new Error('사용자 목록이 비어있음');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'username', 'email', 'online'];",
                  "    const missingFields = requiredFields.filter(field => !users[0].hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    pm.test('모든 사용자 조회 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`모든 사용자 조회 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/users",
              "host": ["{{baseUrl}}"],
              "path": ["users"]
            }
          },
          "response": []
        },
        {
          "name": "사용자 온라인 상태 업데이트 (이영희)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const status = pm.response.json();",
                  "    if (!status.hasOwnProperty('lastAccessAt')) {",
                  "        throw new Error('lastAccessAt 필드가 응답에 없음');",
                  "    }",
                  "    ",
                  "    pm.test('온라인 상태 업데이트 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`온라인 상태 업데이트 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lastAccessAt\": \"{{$isoTimestamp}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users/{{user2Id}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["users", "{{user2Id}}", "status"]
            }
          },
          "response": []
        },
        {
          "name": "사용자 온라인 상태 업데이트 (박민수)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const status = pm.response.json();",
                  "    if (!status.hasOwnProperty('lastAccessAt')) {",
                  "        throw new Error('lastAccessAt 필드가 응답에 없음');",
                  "    }",
                  "    ",
                  "    pm.test('온라인 상태 업데이트 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`온라인 상태 업데이트 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lastAccessAt\": \"{{$isoTimestamp}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users/{{user3Id}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["users", "{{user3Id}}", "status"]
            }
          },
          "response": []
        },
        {
          "name": "사용자 온라인 상태 업데이트 (최지연)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const status = pm.response.json();",
                  "    if (!status.hasOwnProperty('lastAccessAt')) {",
                  "        throw new Error('lastAccessAt 필드가 응답에 없음');",
                  "    }",
                  "    ",
                  "    pm.test('온라인 상태 업데이트 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`온라인 상태 업데이트 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lastAccessAt\": \"{{$isoTimestamp}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/users/{{user4Id}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["users", "{{user4Id}}", "status"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "권한 관리",
      "item": [
        {
          "name": "사용자 로그인 (박민수)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const user = pm.response.json();",
                  "    if (typeof user !== 'object' || Array.isArray(user)) {",
                  "        throw new Error('응답이 객체가 아님');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'username', 'email'];",
                  "    const missingFields = requiredFields.filter(field => !user.hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    // 박민수로 로그인했는지 확인",
                  "    const expectedId = pm.environment.get('user3Id');",
                  "    if (user.id !== expectedId) {",
                  "        throw new Error(`사용자 ID 불일치: ${user.id} (예상: ${expectedId})`);",
                  "    }",
                  "    ",
                  "    pm.test('사용자 로그인 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`사용자 로그인 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"{{user3Name}}\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "채널 관리",
      "item": [
        {
          "name": "공개 채널 생성",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 201) {",
                  "        const error = pm.response.json();",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 201) - ${error.message || ''}`);",
                  "    }",
                  "    ",
                  "    const channel = pm.response.json();",
                  "    if (!channel.id) {",
                  "        throw new Error('생성된 채널에 ID가 없음');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'name'];",
                  "    const missingFields = requiredFields.filter(field => !channel.hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    // isPrivate 필드가 있는 경우에만 검증",
                  "    if (channel.hasOwnProperty('isPrivate') && channel.isPrivate !== false) {",
                  "        throw new Error('공개 채널이 아님');",
                  "    }",
                  "    ",
                  "    // 다음 테스트를 위해 생성된 채널 ID 저장",
                  "    pm.environment.set('createdPublicChannelId', channel.id);",
                  "    ",
                  "    pm.test('공개 채널 생성 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`공개 채널 생성 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"테스트 공개 채널\",\n  \"description\": \"Postman 테스트용 공개 채널\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/channels/public",
              "host": ["{{baseUrl}}"],
              "path": ["channels", "public"]
            }
          },
          "response": []
        },
        {
          "name": "비공개 채널 생성",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 201) {",
                  "        const error = pm.response.json();",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 201) - ${error.message || ''}`);",
                  "    }",
                  "    ",
                  "    const channel = pm.response.json();",
                  "    if (!channel.id) {",
                  "        throw new Error('생성된 채널에 ID가 없음');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'name'];",
                  "    const missingFields = requiredFields.filter(field => !channel.hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    // isPrivate 필드가 있는 경우에만 검증",
                  "    if (channel.hasOwnProperty('isPrivate') && channel.isPrivate !== true) {",
                  "        throw new Error('비공개 채널이 아님');",
                  "    }",
                  "    ",
                  "    // 다음 테스트를 위해 생성된 채널 ID 저장",
                  "    pm.environment.set('createdPrivateChannelId', channel.id);",
                  "    ",
                  "    pm.test('비공개 채널 생성 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`비공개 채널 생성 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"테스트 비공개 채널\",\n  \"description\": \"Postman 테스트용 비공개 채널\",\n  \"memberIds\": [\"{{user2Id}}\", \"{{user3Id}}\"]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/channels/private",
              "host": ["{{baseUrl}}"],
              "path": ["channels", "private"]
            }
          },
          "response": []
        },
        {
          "name": "공개 채널 정보 수정",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const channel = pm.response.json();",
                  "    const expectedId = pm.environment.get('createdPublicChannelId');",
                  "    if (channel.id !== expectedId) {",
                  "        throw new Error(`채널 ID 불일치: ${channel.id} (예상: ${expectedId})`);",
                  "    }",
                  "    ",
                  "    pm.test('공개 채널 정보 수정 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`공개 채널 정보 수정 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"수정된 공개 채널\",\n  \"description\": \"채널 정보가 수정되었습니다\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/channels/{{createdPublicChannelId}}",
              "host": ["{{baseUrl}}"],
              "path": ["channels", "{{createdPublicChannelId}}"]
            }
          },
          "response": []
        },
        {
          "name": "채널 삭제",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 204) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 204)`);",
                  "    }",
                  "    ",
                  "    pm.test('채널 삭제 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`채널 삭제 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/channels/{{createdPrivateChannelId}}",
              "host": ["{{baseUrl}}"],
              "path": ["channels", "{{createdPrivateChannelId}}"]
            }
          },
          "response": []
        },
        {
          "name": "특정 사용자의 모든 채널 목록 조회",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const channels = pm.response.json();",
                  "    if (!Array.isArray(channels)) {",
                  "        throw new Error('응답이 배열이 아님');",
                  "    }",
                  "    ",
                  "    if (channels.length === 0) {",
                  "        throw new Error('채널 목록이 비어있음');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'name'];",
                  "    const missingFields = requiredFields.filter(field => !channels[0].hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    pm.test('채널 목록 조회 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`채널 목록 조회 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/channels?userId={{user2Id}}",
              "host": ["{{baseUrl}}"],
              "path": ["channels"],
              "query": [
                {
                  "key": "userId",
                  "value": "{{user2Id}}"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "메시지 관리",
      "item": [
        {
          "name": "메시지 보내기",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 201) {",
                  "        const error = pm.response.json();",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 201) - ${error.message || ''}`);",
                  "    }",
                  "    ",
                  "    const message = pm.response.json();",
                  "    if (!message.id) {",
                  "        throw new Error('생성된 메시지에 ID가 없음');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'content', 'channelId', 'authorId'];",
                  "    const missingFields = requiredFields.filter(field => !message.hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    // 다음 테스트를 위해 생성된 메시지 ID 저장",
                  "    pm.environment.set('createdMessageId', message.id);",
                  "    ",
                  "    pm.test('메시지 보내기 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`메시지 보내기 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"Postman 테스트 메시지\",\n  \"channelId\": \"{{createdPublicChannelId}}\",\n  \"authorId\": \"{{user2Id}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/messages",
              "host": ["{{baseUrl}}"],
              "path": ["messages"]
            }
          },
          "response": []
        },
        {
          "name": "메시지 수정",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const message = pm.response.json();",
                  "    const expectedId = pm.environment.get('createdMessageId');",
                  "    if (message.id !== expectedId) {",
                  "        throw new Error(`메시지 ID 불일치: ${message.id} (예상: ${expectedId})`);",
                  "    }",
                  "    ",
                  "    pm.test('메시지 수정 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`메시지 수정 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"수정된 메시지 내용\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/messages/{{createdMessageId}}",
              "host": ["{{baseUrl}}"],
              "path": ["messages", "{{createdMessageId}}"]
            }
          },
          "response": []
        },
        {
          "name": "메시지 삭제",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 204) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 204)`);",
                  "    }",
                  "    ",
                  "    pm.test('메시지 삭제 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`메시지 삭제 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/messages/{{createdMessageId}}",
              "host": ["{{baseUrl}}"],
              "path": ["messages", "{{createdMessageId}}"]
            }
          },
          "response": []
        },
        {
          "name": "특정 채널의 메시지 목록 조회",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const messages = pm.response.json();",
                  "    if (!Array.isArray(messages)) {",
                  "        throw new Error('응답이 배열이 아님');",
                  "    }",
                  "    ",
                  "    // 메시지가 삭제되어 비어있을 수 있으므로 경고만 출력",
                  "    if (messages.length === 0) {",
                  "        console.log('경고: 메시지 목록이 비어있음 (이전 테스트에서 삭제됨)');",
                  "    } else {",
                  "        // 메시지가 있으면 필드 검증",
                  "        const requiredFields = ['id', 'content', 'channelId', 'authorId'];",
                  "        const missingFields = requiredFields.filter(field => !messages[0].hasOwnProperty(field));",
                  "        if (missingFields.length > 0) {",
                  "            throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "        }",
                  "    }",
                  "    ",
                  "    pm.test('메시지 목록 조회 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`메시지 목록 조회 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/messages?channelId={{createdPublicChannelId}}",
              "host": ["{{baseUrl}}"],
              "path": ["messages"],
              "query": [
                {
                  "key": "channelId",
                  "value": "{{createdPublicChannelId}}"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "메시지 수신 정보 관리",
      "item": [
        {
          "name": "특정 채널의 메시지 수신 정보 생성",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200 && pm.response.code !== 201) {",
                  "        const error = pm.response.json();",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 201) - ${error.message || ''}`);",
                  "    }",
                  "    ",
                  "    const readStatus = pm.response.json();",
                  "    if (!readStatus.id) {",
                  "        throw new Error('생성된 수신 정보에 ID가 없음');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'userId', 'channelId'];",
                  "    const missingFields = requiredFields.filter(field => !readStatus.hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    // 다음 테스트를 위해 생성된 수신 정보 ID 저장",
                  "    pm.environment.set('createdReadStatusId', readStatus.id);",
                  "    ",
                  "    pm.test('메시지 수신 정보 생성 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`메시지 수신 정보 생성 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{user2Id}}\",\n  \"channelId\": \"{{createdPublicChannelId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/read-statuses",
              "host": ["{{baseUrl}}"],
              "path": ["read-statuses"]
            }
          },
          "response": []
        },
        {
          "name": "특정 채널의 메시지 수신 정보 수정",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const readStatus = pm.response.json();",
                  "    const expectedId = pm.environment.get('createdReadStatusId');",
                  "    if (readStatus.id !== expectedId) {",
                  "        throw new Error(`수신 정보 ID 불일치: ${readStatus.id} (예상: ${expectedId})`);",
                  "    }",
                  "    ",
                  "    pm.test('메시지 수신 정보 수정 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`메시지 수신 정보 수정 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lastReadMessageId\": \"{{createdMessageId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/read-statuses/{{createdReadStatusId}}",
              "host": ["{{baseUrl}}"],
              "path": ["read-statuses", "{{createdReadStatusId}}"]
            }
          },
          "response": []
        },
        {
          "name": "특정 사용자의 메시지 수신 정보 조회",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const readStatuses = pm.response.json();",
                  "    if (!Array.isArray(readStatuses)) {",
                  "        throw new Error('응답이 배열이 아님');",
                  "    }",
                  "    ",
                  "    if (readStatuses.length === 0) {",
                  "        throw new Error('수신 정보 목록이 비어있음');",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'userId', 'channelId'];",
                  "    const missingFields = requiredFields.filter(field => !readStatuses[0].hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    pm.test('메시지 수신 정보 조회 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`메시지 수신 정보 조회 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/read-statuses?userId={{user2Id}}",
              "host": ["{{baseUrl}}"],
              "path": ["read-statuses"],
              "query": [
                {
                  "key": "userId",
                  "value": "{{user2Id}}"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "바이너리 파일 다운로드",
      "item": [
        {
          "name": "바이너리 파일 1개 조회",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const content = pm.response.json();",
                  "    const expectedId = pm.environment.get('user2ProfileId');",
                  "    if (content.id !== expectedId) {",
                  "        throw new Error(`파일 ID 불일치: ${content.id} (예상: ${expectedId})`);",
                  "    }",
                  "    ",
                  "    const requiredFields = ['id', 'filename', 'contentType'];",
                  "    const missingFields = requiredFields.filter(field => !content.hasOwnProperty(field));",
                  "    if (missingFields.length > 0) {",
                  "        throw new Error(`필수 필드 누락: ${missingFields.join(', ')}`);",
                  "    }",
                  "    ",
                  "    pm.test('파일 1개 조회 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`파일 1개 조회 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/binary-contents/{{user2ProfileId}}",
              "host": ["{{baseUrl}}"],
              "path": ["binary-contents", "{{user2ProfileId}}"]
            }
          },
          "response": []
        },
        {
          "name": "바이너리 파일 여러 개 조회 (2명)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const contents = pm.response.json();",
                  "    if (!Array.isArray(contents)) {",
                  "        throw new Error('응답이 배열이 아님');",
                  "    }",
                  "    ",
                  "    if (contents.length === 0) {",
                  "        throw new Error('조회된 파일이 없음');",
                  "    }",
                  "    ",
                  "    pm.test('파일 여러 개 조회 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`파일 여러 개 조회 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/binary-contents?ids={{user2ProfileId}},{{user3ProfileId}}",
              "host": ["{{baseUrl}}"],
              "path": ["binary-contents"],
              "query": [
                {
                  "key": "ids",
                  "value": "{{user2ProfileId}},{{user3ProfileId}}"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "바이너리 파일 여러 개 조회 (전체)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "try {",
                  "    if (pm.response.code !== 200) {",
                  "        throw new Error(`상태 코드 오류: ${pm.response.code} (예상: 200)`);",
                  "    }",
                  "    ",
                  "    const contents = pm.response.json();",
                  "    if (!Array.isArray(contents)) {",
                  "        throw new Error('응답이 배열이 아님');",
                  "    }",
                  "    ",
                  "    if (contents.length === 0) {",
                  "        throw new Error('조회된 파일이 없음');",
                  "    }",
                  "    ",
                  "    pm.test('파일 여러 개 조회 성공', () => {",
                  "        pm.expect(true).to.be.true;",
                  "    });",
                  "} catch (error) {",
                  "    pm.test(`파일 여러 개 조회 실패: ${error.message}`, () => {",
                  "        pm.expect.fail(error.message);",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/binary-contents?ids={{user2ProfileId}},{{user3ProfileId}},{{user4ProfileId}}",
              "host": ["{{baseUrl}}"],
              "path": ["binary-contents"],
              "query": [
                {
                  "key": "ids",
                  "value": "{{user2ProfileId}},{{user3ProfileId}},{{user4ProfileId}}"
                }
              ]
            }
          },
          "response": []
        }
      ]
    }
  ]
}
